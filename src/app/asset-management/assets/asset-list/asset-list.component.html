<!-- Asset List Component -->
<div class="asset-list-container">
  <!-- Header -->
  <div class="page-header">
    <h1>Asset Management</h1>
    <p>Manage and track all college assets</p>
  </div>

  <!-- Toolbar -->
  <p-toolbar styleClass="mb-4">
    <ng-template pTemplate="left">
      <button
        pButton
        type="button"
        label="New Asset"
        icon="pi pi-plus"
        class="mr-2"
        (click)="createAsset()"
      ></button>
      <button
        pButton
        type="button"
        label="Export"
        icon="pi pi-upload"
        severity="secondary"
        class="mr-2"
        (click)="exportAssets()"
      ></button>
      <button
        pButton
        type="button"
        label="Import"
        icon="pi pi-download"
        severity="secondary"
        (click)="importAssets()"
      ></button>
    </ng-template>
    <ng-template pTemplate="right">
      <button
        pButton
        type="button"
        icon="pi pi-refresh"
        severity="secondary"
        (click)="refreshData()"
      ></button>
    </ng-template>
  </p-toolbar>

  <!-- Filters -->
  <p-card header="Filters" styleClass="mb-4">
    <div class="grid">
      <div class="col-12 md:col-6 lg:col-3">
        <label for="search" class="block text-sm font-medium mb-2"
          >Search</label
        >
        <input
          pInputText
          id="search"
          [(ngModel)]="searchQuery"
          placeholder="Search assets..."
          class="w-full"
          (input)="onSearchInput()"
        />
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <label for="category" class="block text-sm font-medium mb-2"
          >Category</label
        >
        <p-dropdown
          id="category"
          [options]="categories"
          [(ngModel)]="selectedCategory"
          placeholder="All Categories"
          class="w-full"
          (onChange)="onFilterChange()"
          [showClear]="true"
        ></p-dropdown>
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <label for="status" class="block text-sm font-medium mb-2"
          >Status</label
        >
        <p-dropdown
          id="status"
          [options]="statuses"
          [(ngModel)]="selectedStatus"
          placeholder="All Statuses"
          class="w-full"
          (onChange)="onFilterChange()"
          [showClear]="true"
        ></p-dropdown>
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <label for="condition" class="block text-sm font-medium mb-2"
          >Condition</label
        >
        <p-dropdown
          id="condition"
          [options]="conditions"
          [(ngModel)]="selectedCondition"
          placeholder="All Conditions"
          class="w-full"
          (onChange)="onFilterChange()"
          [showClear]="true"
        ></p-dropdown>
      </div>
    </div>
    <div class="mt-3">
      <button
        pButton
        type="button"
        label="Clear Filters"
        severity="secondary"
        size="small"
        (click)="clearFilters()"
      ></button>
    </div>
  </p-card>

  <!-- Assets Table -->
  <p-card>
    <p-table
      [value]="filteredAssets"
      [loading]="loading"
      [paginator]="true"
      [rows]="rows"
      [first]="first"
      [totalRecords]="filteredAssets.length"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} assets"
      [(selection)]="selectedAssets"
      dataKey="id"
      styleClass="p-datatable-striped"
    >
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 3rem">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th pSortableColumn="assetTag">
            Asset Tag <p-sortIcon field="assetTag"></p-sortIcon>
          </th>
          <th pSortableColumn="name">
            Name <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="category">
            Category <p-sortIcon field="category"></p-sortIcon>
          </th>
          <th pSortableColumn="status">
            Status <p-sortIcon field="status"></p-sortIcon>
          </th>
          <th pSortableColumn="condition">
            Condition <p-sortIcon field="condition"></p-sortIcon>
          </th>
          <th pSortableColumn="currentValue">
            Value <p-sortIcon field="currentValue"></p-sortIcon>
          </th>
          <th pSortableColumn="assignedTo">
            Assigned To <p-sortIcon field="assignedTo"></p-sortIcon>
          </th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-asset>
        <tr>
          <td>
            <p-tableCheckbox [value]="asset"></p-tableCheckbox>
          </td>
          <td>
            <span class="font-medium">{{ asset.assetTag }}</span>
          </td>
          <td>
            <div>
              <div class="font-medium">{{ asset.name }}</div>
              <div class="text-sm text-gray-500">
                {{ asset.brand }} {{ asset.model }}
              </div>
            </div>
          </td>
          <td>
            <p-tag [value]="asset.category" severity="info"></p-tag>
          </td>
          <td>
            <p-tag
              [value]="asset.status"
              [severity]="getStatusSeverity(asset.status)"
            ></p-tag>
          </td>
          <td>
            <p-tag
              [value]="asset.condition"
              [severity]="getConditionSeverity(asset.condition)"
            ></p-tag>
          </td>
          <td>
            {{ formatCurrency(asset.currentValue) }}
          </td>
          <td>
            {{ asset.assignedTo || "Unassigned" }}
          </td>
          <td>
            <div class="flex gap-2">
              <button
                pButton
                type="button"
                icon="pi pi-eye"
                size="small"
                severity="secondary"
                (click)="viewAsset(asset)"
                pTooltip="View Details"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-pencil"
                size="small"
                (click)="editAsset(asset)"
                pTooltip="Edit Asset"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-wrench"
                size="small"
                severity="warning"
                (click)="createMaintenanceRequest(asset)"
                pTooltip="Create Maintenance Request"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-trash"
                size="small"
                severity="danger"
                (click)="deleteAsset(asset)"
                pTooltip="Delete Asset"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="9" class="text-center">No assets found</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>

  <!-- Bulk Actions -->
  <div *ngIf="selectedAssets.length > 0" class="mt-4">
    <p-card>
      <div class="flex align-items-center gap-3">
        <span>{{ selectedAssets.length }} asset(s) selected</span>
        <button
          pButton
          type="button"
          label="Delete Selected"
          icon="pi pi-trash"
          severity="danger"
          size="small"
          (click)="deleteSelectedAssets()"
        ></button>
      </div>
    </p-card>
  </div>
</div>

<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>
