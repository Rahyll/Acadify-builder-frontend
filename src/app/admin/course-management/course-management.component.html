<div class="course-management">
  <div class="page-header">
    <h1>Course Management</h1>
    <p>Manage courses and academic programs</p>
  </div>

  <p-card>
    <p-toolbar>
      <div class="p-toolbar-group-start">
        <span class="p-input-icon-left">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            [(ngModel)]="globalFilter"
            placeholder="Search courses..."
            class="p-inputtext-sm"
          />
        </span>
      </div>
      <div class="p-toolbar-group-end">
        <p-button
          label="Add Course"
          icon="pi pi-plus"
          (onClick)="onAddCourse()"
          styleClass="p-button-sm"
        ></p-button>
      </div>
    </p-toolbar>

    <p-table
      [value]="courses"
      [loading]="loading"
      [globalFilterFields]="['name', 'code', 'department']"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 20]"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      styleClass="p-datatable-striped"
      responsiveLayout="scroll"
      #dt
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">
            Course Name <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="code">
            Code <p-sortIcon field="code"></p-sortIcon>
          </th>
          <th pSortableColumn="department">
            Department <p-sortIcon field="department"></p-sortIcon>
          </th>
          <th pSortableColumn="duration">
            Duration <p-sortIcon field="duration"></p-sortIcon>
          </th>
          <th pSortableColumn="totalCredits">
            Credits <p-sortIcon field="totalCredits"></p-sortIcon>
          </th>
          <th pSortableColumn="status">
            Status <p-sortIcon field="status"></p-sortIcon>
          </th>
          <th>Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-course>
        <tr>
          <td>
            <div class="course-info">
              <div class="course-name">{{ course.name }}</div>
              <div class="course-description">{{ course.description }}</div>
            </div>
          </td>
          <td>
            <p-tag [value]="course.code" severity="info"></p-tag>
          </td>
          <td>{{ course.department }}</td>
          <td>{{ course.duration }} semesters</td>
          <td>{{ course.totalCredits }}</td>
          <td>
            <p-tag
              [value]="course.status | titlecase"
              [severity]="getStatusSeverity(course.status)"
            ></p-tag>
          </td>
          <td>
            <div class="action-buttons">
              <p-button
                icon="pi pi-pencil"
                (onClick)="onEditCourse(course)"
                styleClass="p-button-rounded p-button-text p-button-sm"
                pTooltip="Edit course"
              ></p-button>
              <p-button
                icon="pi pi-trash"
                (onClick)="onDeleteCourse(course)"
                styleClass="p-button-rounded p-button-text p-button-danger p-button-sm"
                pTooltip="Delete course"
              ></p-button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7" class="text-center">
            <div class="empty-state">
              <i class="pi pi-book"></i>
              <h3>No courses found</h3>
              <p>Get started by adding your first course</p>
              <p-button
                label="Add Course"
                icon="pi pi-plus"
                (onClick)="onAddCourse()"
              ></p-button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>

  <!-- Course Form Dialog -->
  <app-course-form
    [visible]="showCourseForm"
    [course]="selectedCourse"
    (visibleChange)="onCourseFormClose()"
    (courseSaved)="onCourseSaved()"
  ></app-course-form>

  <!-- Confirmation Dialog -->
  <p-confirmDialog></p-confirmDialog>
</div>
